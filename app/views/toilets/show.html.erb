<div class="container">
  <div class="row">
    <div class="col col-sm-8">
      <div class="mt-3 mx-3">
        <div class="card-product">
          <%= cl_image_tag(@toilet.photo.key, width: 400, height: 300) %>
          <div class="card-product-infos">
            <h1><%= @toilet.name %></h1>
            <p class="fs-4"><b><%= @toilet.description %></b></p>
            <p class="fs-4">Â¥<b><%= @toilet.price %></b></p>
          </div>
        </div>
        <div style="width: 100%; height: 600px;"
        data-controller="map"
        data-map-markers-value="<%= @markers.to_json %>"
        data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>
      </div>
    </div>
    <div class="col col-sm-4">
      <div>
        <% if @toilet.user != current_user %>
          <div class="mt-5">
            <h3>Book this toilet</h3>
            <%= simple_form_for [@toilet, @booking] do |f| %>
              <%= f.input :start_time,
              as: :string,
              input_html: { data: { controller: "datepicker" } } %>
              <%= f.input :end_time,
              as: :string,
              input_html: { data: { controller: "datepicker" } } %>
              <%= f.submit "Reserve This Toilet", url: bookings_path, class: "btn btn-custom mb-5" %>
            <% end %>
            <%# User Review Form %>
            <h3>Leave a Review</h3>
            <%= simple_form_for [@toilet, @review] do |f| %>
              <%= f.input :content %>
              <%= f.submit "Leave Review", url: toilet_reviews_path(@toilet), class: "btn btn-custom mb-5" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <%# User Review Display Area %>
  <div class="row">
    <div class="col-12 mb-5">
      <h3>User Reviews</h3>
      <% @reviews.each do |review| %>
        <div class="card" style="width: 30rem;">
          <div class="card-body">
            <h5 class="card-title"><%= review.content %></h5>
            <p class="card-text"><%= review.user.name %></p>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
