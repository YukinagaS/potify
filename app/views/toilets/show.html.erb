<div class="container">
  <div class="row">
    <!-- Left Column: Toilet Info, Photos, Reviews, and Review Form -->
    <div class="col col-md-7 mt-3" style="padding: 0; border: none;">
      <div class="mt-3 mx-3">
        <div class="card-product">
          <div class="image-gallery">
            <% @toilet.photos.each_with_index do |photo, index| %>
              <% if index == 0 %>
                <!-- First image with a larger size -->
                <%= cl_image_tag(photo.key) %> <!-- Size for the first image -->
              <% elsif index == 1 %>
                <!-- Start grouping images 2, 3, and 4 -->
                <div class="other-images">
                  <%= cl_image_tag(photo.key) %> <!-- Image 2 -->
                <% elsif index.between?(2, 3) %>
                  <!-- Images 3 and 4 -->
                  <%= cl_image_tag(photo.key) %> <!-- Image 3 and 4 -->
                <% else %>
                  <!-- Optional: Handle images after 4 if needed -->
                  <div class="other-images">
                    <%= cl_image_tag(photo.key) %>
                  </div>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
        <!-- Toilet Info -->
        <div class="card-product-infos mt-3">
          <h2><b><%= @toilet.name %></b></h2>
          <p class="fs-6"><%= @toilet.description %></p>
          <p class="fs-4"><b>Â¥<%= @toilet.price %></b> / hour</p>
        </div>
        <!-- User Reviews Section -->
        <div class="mt-4">
          <hr style="border: 1px solid #ccc;">
          <h3>User Reviews</h3>
          <% if @reviews.any? %>
            <% @reviews.each do |review| %>
              <div class="card mb-3" style="width: 30rem;">
                <div class="card-body">
                  <h5 class="card-title"><%= review.content %></h5>
                  <p class="card-text"><%= review.user.name %></p>
                </div>
              </div>
            <% end %>
          <% else %>
            <p>No reviews yet.</p>
          <% end %>
        </div>
        <!-- Leave a Review Form -->
        <% if @toilet.user != current_user %>
          <div class="mt-5">
            <h3>Leave a Review</h3>
            <%= simple_form_for [@toilet, @review] do |f| %>
              <%= f.input :content %>
              <%= f.submit "Leave Review", url: toilet_reviews_path(@toilet), class: "btn btn-custom mb-5" %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
    <!-- Right Column: Map and Booking Form (Aligns with Toilet Name) -->
    <div class="col-md-4 mt-3 d-flex flex-column">
      <!-- Map Section -->
      <div id="map" class="map-container"
        data-controller="map"
        data-map-markers-value="<%= @markers.to_json %>"
        data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
      <% if @toilet.user != current_user %>
        <!-- Booking Form (Aligned with Toilet Name) -->
        <div class="mt-4">
          <h3>Book this toilet</h3>
          <%= simple_form_for [@toilet, @booking] do |f| %>
            <input type="date" name="booking[date]" data-controller="datepicker">
            <% time_slots = ["9:00", "10:00", "11:00", "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00"] %>
            <%= f.input :start_time, as: :select, collection: time_slots %>
            <%= f.input :end_time, as: :select, collection: time_slots %>
            <%= f.submit "Reserve This Toilet", url: bookings_path, class: "btn btn-custom mb-5" %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
</div>
